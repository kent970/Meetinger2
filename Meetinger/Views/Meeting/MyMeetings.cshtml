@using Meetinger.Areas.Identity.Data
@using Microsoft.AspNetCore.Identity
@model IEnumerable<Meeting>
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "MyMeetings";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>MyMeetings</h1>

@foreach (var meeting in Model)
{
    <h2>Meeting</h2>
    <h5>@meeting.Name</h5>
    <h5>@meeting.Description</h5>
    <h5>@meeting.MeetingTime</h5>
    <h5>@meeting.Creator.FirstName</h5>
    
    <div>
        <input type="radio" class="form-check-input add-button"  name="selectedUser" value="false" data-meeting-id="@meeting.Id">
        <label class="form-check-label">No</label>
    </div>
    <div>
        <input type="radio" class="form-check-input add-button"  name="selectedUser" value="true" data-meeting-id="@meeting.Id">
        <label class="form-check-label" >Yes</label>
    </div>
    
}

@section Scripts
    {
    <script>
        $(".add-button").click(function () {
            var attendanceValue = $(this).val();
            var meetingId = $(this).data("meeting-id");

            $.ajax({
                type: "POST",
                url: "/Meeting/SetAttendance",
                data: {
                    attendance: attendanceValue,
                    meetingId: meetingId
                },
                success: function () {
                    alert("Attendance set successfully");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log("Ajax request error:");
                    console.log("Status: " + textStatus);
                    console.log("Error: " + errorThrown);
                }
            });
        });
    </script>
}